sudo: false

language: java

matrix:
  fast_finish: true
  include:
  - os: linux
    jdk: oraclejdk8
    env: DISPLAY=:99.0

install: true

before_install:
- echo "MAVEN_OPTS='-Xmx2048m -XX:MaxPermSize=512m'" > ~/.mavenrc

script:
- cd clouddesigner/org.occiware.clouddesigner.parent
- mvn clean verify -Pbuild.products

# Actions to perform after the build.
after_success:
# TODO - mvn clean deploy --settings ${TRAVIS_BUILD_DIR}/travis/settings.xml 
# TODO - mvn clean verify -Pbuild.products
- cd ${TRAVIS_BUILD_DIR}
- sh travis/tag_current_release.sh

deploy:
  provider: releases
  api_key:
    secure: "B7gAeYhX7E867Wk/AvgOAKxYlXoA3yPBPZjwce7Zl7+9rszraXPGV/WM5D+oTL8D0Da1k1hcqvsfSEgBjS1O+un3FEuscXOg8QsEKHy0EBi7P/935UfDngEfgE975euHU1sQy5MrjUMMwF85fmjVZBXym6mIfFSSD5FgiTNcd44VThzDwflSOZ8TYxnbQ2JWkFRK6NZvIn8NrwJTjhIi1SfjY33Bx3Rygps3+p0ouxoc9lowB6kwSpsoDZY3VM2zjWW5kfIaiIfQFJJjlOkd5Ec/Yawseh1Vto2jPbxYlDWY414Aukp1rnQ+RGH1n6DnVW+3NbxheoSqz0e2grv1ktFTYC7IZm/U9lKgLiERE/ahssft/9mQRoPYfdJqLsAxP/y6XB2eVYxtvK5XPPOeBayFJhzBsdNK+E9VZVb5YbtREMoM21OnuCfqNZDhNFpze4Do/BNqwoAqQChsVVDPz8LzuaubVZ1FyTJ8QqcXxO0/+9re9dAu2GE/Ld0c69vczI7e5vdv7rPEfzJqyASNN6XJZdIrNj4UdtXdRynqFlC/CC0+XsmwdBNph8wCJ+//yDTwUdL6576earZ8mL2eWrlanci8hYgNwRHD0BxPxmtyftvQ2HY56cUj9GFv3u/ZkLLoC/ferzyce8w8U1uyS2q5QwwbwxmjN+v6mfYTLug="
  file:
    - "clouddesigner/org.occiware.clouddesigner.product/target/products/org.occiware.clouddesigner.product-linux.gtk.x86_64.zip"
    - "clouddesigner/org.occiware.clouddesigner.product/target/products/org.occiware.clouddesigner.product-macosx.cocoa.x86_64.zip"
    - "clouddesigner/org.occiware.clouddesigner.product/target/products/org.occiware.clouddesigner.product-win32.win32.x86_64.zip"
  skip_cleanup: true
  overwrite: true
  on:
    tags: true
    repo: philippemerle/ecore

env:
  global:
  - secure: Lp/h2cwzh5j6iT7OBmKmg8WUFnY7WWTj9X9/nvqiV8B92wW1I4LOc97RWpzidR7hBk/Z0NtHUuVd8Djd5WBEN5BKJ9Bchrpx9JBnb0hmdD45YhBIm4G8R3bctbg6Q2xDM8RbaTv/uwUl7/sE+9BFv+oIEOZ4s01yzIEutwGeKyA=
  - secure: L/K7jwoNcRw+38eTYq6US8jCNZdCFWFgF4mOsy6/sMMt/14KdZBe7bXKwfm5j9ZuqlPaiKPNPIFfI2isG4wGenXbNgODsE6qZPglyAAxSOwivKDBQtC3Uqqwuh6ZtmBuATg9ZNLAb1Dw3Stz2ipMTRSbYzImx4QB7/6QteSaaZk=
  - secure: "i29DNm7iFjDFYRmUppse6+jAE3rNLkHRSGYbH3QwdB7+SpJvjYYRVY8ftUHnwsAYT6+yxTJ5TmAvv6aVqKLtehYrhX5jbZGfgACBFFkav88pUpETMli0Fb3IZ0RNQLzQ4Preo2c9DEnsypum0RhAaPB4rrP3iXxqtj5ndsYwzztx/KLfJ2AC7Rif+eqa6MroaEq/nlsT9suJ93QfIAQts8r0jX7sBowN7D0iobUZ/Fv/dEkjRVxC5RRkzqXdh2Dh+p+kPsHDQ+J6UuOd9omMCFjxrCEgPgimyA8PhcqlTehTK9fpMMkohkThIvjSJw4pvYAFRiJYWfsqX6aWC3lWX2Os5avpsMP2pP+v5LYPL/j5kOp8BqumR4jqw248+kGBJVR4yqAF5yRhkDZKPjhdYcu/SopwmRuSMa6jGWMCDvrEC4KQgPgR60d2n5sRZ9rppL1f1SUdmF+2g/N2s5uH/AwInambVT7SQJwRwl1cyYucWyqhVPGKi+JHpJ1sdUhbLJFzstqsQC4jSidBQyjvUDffYW13OJtB/5JWzK0BoGoS9XP1cqoKpnBWb+hdUH+MfeGOdKiVh5whMXE+adcxyVdeLcQD9/Gqfhj9MgOkPiBL6L6dBHNI/6QKTgOAAJgQTvj824kkO7eBucSgQqn22S+4aAWzco/MB5WOt8n6r5w="

cache:
  directories:
  - $HOME/.m2

